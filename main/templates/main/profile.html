{% extends 'main/base.html' %}

{% block content %}
<div class="container">
    <div class="profile-header">
        {% if profile.avatar %}
            <img src="{{ profile.avatar.url }}" alt="{{ profile_user.username }}" class="profile-avatar">
        {% else %}
            <div class="profile-avatar no-avatar">
                {{ profile_user.username|first|upper }}
            </div>
        {% endif %}
        <div>
            <h1>{{ profile_user.username }}</h1>
            {% if profile_user == user %}
                <a href="{% url 'profile_edit' %}" class="btn btn-outline">Редактировать профиль</a>
            {% endif %}
        </div>
    </div>

    <div class="profile-info">
        {% if profile.bio %}
            <div class="bio">{{ profile.bio|linebreaks }}</div>
        {% endif %}

        <div class="profile-stats">
            <div class="stat">
                <strong>{{ user_threads.count }}</strong>
                <span>Созданных тредов</span>
            </div>
            <div class="stat">
                <strong>{{ user_comments.count }}</strong>
                <span>Комментариев</span>
            </div>
            <div class="stat">
                <strong>{{ profile_user.date_joined|date:"d.m.Y" }}</strong>
                <span>На сайте с</span>
            </div>
        </div>
    </div>

    <!-- Активность пользователя -->
    <div class="profile-activity">
        <h3>Последние треды</h3>
        {% for thread in user_threads %}
            <div class="activity-item">
                <a href="{% url 'thread_detail' thread.id %}">{{ thread.title }}</a>
                <small>{{ thread.created_at|date:"d.m.Y H:i" }}</small>
            </div>
        {% empty %}
            <p>Пока нет созданных тредов</p>
        {% endfor %}

        <h3>Последние комментарии</h3>
        {% for comment in user_comments %}
            <div class="activity-item">
                <a href="{% url 'thread_detail' comment.thread.id %}#comment-{{ comment.id }}">
                    {{ comment.content|truncatechars:50 }}
                </a>
                <small>{{ comment.created_at|date:"d.m.Y H:i" }}</small>
            </div>
        {% empty %}
            <p>Пока нет комментариев</p>
        {% endfor %}
    </div>
</div>

<style>
.profile-header {
    display: flex;
    align-items: center;
    gap: 2rem;
    margin-bottom: 2rem;
}

.profile-avatar {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    object-fit: cover;
    border: 4px solid var(--primary-color);
}

.profile-stats {
    display: flex;
    gap: 2rem;
    margin: 2rem 0;
}

.stat {
    text-align: center;
    padding: 1rem;
    background: var(--bg-secondary);
    border-radius: 8px;
    min-width: 100px;
}

.stat strong {
    display: block;
    font-size: 1.5rem;
    color: var(--primary-color);
}

.activity-item {
    background: var(--bg-secondary);
    padding: 1rem;
    margin-bottom: 0.5rem;
    border-radius: 6px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.activity-item:hover {
    background: var(--card-bg);
}

.bio {
    font-size: 1.1rem;
    line-height: 1.6;
    padding: 1.5rem;
    background: var(--bg-secondary);
    border-radius: 8px;
    margin: 1rem 0;
}
</style>
{% endblock %}
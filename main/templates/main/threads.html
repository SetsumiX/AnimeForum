{% extends 'main/base.html' %}
{% load static %}

{% block content %}
<div style="text-align: right; margin-bottom: 1rem;">
    {% if user.is_authenticated %}
        <a href="{% url 'create_thread' %}" class="btn btn-primary" style="text-decoration: none;">Создать форум</a>
    {% else %}
        <a href="{% url 'login' %}" class="btn btn-primary" style="text-decoration: none;">Авторизоваться для создания форума</a>
    {% endif %}
</div>

<div class="tabs">
    <div class="tabs-list">
        <a href="{% url 'news_page' %}" class="tab-trigger">Новости</a>
        <a href="{% url 'forums_page' %}" class="tab-trigger active">Форум</a>
    </div>

    <div class="tab-content active" id="forum">
        <div class="section-header">
            <h2>Темы форума</h2>
            <p class="text-muted">Всего тем: {{ threads.count }}</p>
        </div>

        <div class="forum-list" id="forumList">
            {% for thread in threads %}
                <div class="forum-card">
                  <div class="forum-card-content">
                    <div class="forum-avatar">{{thread.author.username|first|upper}}</div>
                    <div class="forum-info">
                      <div class="forum-badge">{{thread.category}}</div>
                      <h3>{{thread.title}}</h3>
                      <div class="forum-meta">
                        <div class="forum-meta-item">
                          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                          </svg>
                        </div>
                        <div class="forum-meta-item">
                          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                          </svg>
                          <span>{{thread.count_messages}} сообщений</span>
                        </div>
                        <div class="forum-meta-item">
                          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <polyline points="12 6 12 12 16 14"></polyline>
                          </svg>
                          <span>{{thread.last_message_time|timesince}} назад</span>
                        </div>
                      </div>
                      <div class="forum-stats">
                        <div class="forum-stats-number">{{thread.count_views}}</div>
                        <div class="forum-stats-label">просмотров</div>
                      </div>
                    </div>
                  </div>
                </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}